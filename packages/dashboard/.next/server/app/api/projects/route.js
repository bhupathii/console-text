"use strict";(()=>{var e={};e.id=871,e.ids=[871],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},98216:e=>{e.exports=require("net")},68621:e=>{e.exports=require("punycode")},86624:e=>{e.exports=require("querystring")},76162:e=>{e.exports=require("stream")},82452:e=>{e.exports=require("tls")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},22614:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>j,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>x});var s={};t.r(s),t.d(s,{GET:()=>c,POST:()=>p});var o=t(63036),n=t(5736),a=t(15262),i=t(60942);let u=Object.entries({NEXT_PUBLIC_SUPABASE_URL:"https://rmuwpnlgkuphctznykli.supabase.co",SUPABASE_SERVICE_ROLE_KEY:process.env.SUPABASE_SERVICE_ROLE_KEY}).filter(([e,r])=>!r).map(([e])=>e);async function p(e){if(u.length>0)return i.NextResponse.json({error:"Service not configured",missing:u,message:"Required environment variables are not set. Please configure your database connection."},{status:503});try{let{getServerSession:r}=await t.e(295).then(t.bind(t,1295)),{createClient:s}=await t.e(235).then(t.bind(t,59235)),o=s("https://rmuwpnlgkuphctznykli.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY),n=await r();if(!n?.user?.email)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{data:a,error:u}=await o.from("users").select("*").eq("email",n.user.email).single();if(u||!a)return i.NextResponse.json({error:"User not found"},{status:404});let{name:p}=await e.json();if(!p||!p.trim())return i.NextResponse.json({error:"Project name is required"},{status:400});let{data:c,error:l}=await o.rpc("generate_api_key");if(l)return console.error("Error generating API key:",l),i.NextResponse.json({error:"Failed to generate API key"},{status:500});let{data:d,error:x}=await o.from("projects").insert({user_id:a.id,name:p.trim(),api_key:c,telegram_configured:!1}).select().single();if(x)return console.error("Error creating project:",x),i.NextResponse.json({error:"Failed to create project"},{status:500});return i.NextResponse.json(d)}catch(e){return console.error("Project creation error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function c(e){if(u.length>0)return i.NextResponse.json({error:"Service not configured",missing:u,message:"Required environment variables are not set. Please configure your database connection."},{status:503});try{let{getServerSession:e}=await t.e(295).then(t.bind(t,1295)),{createClient:r}=await t.e(235).then(t.bind(t,59235)),s=r("https://rmuwpnlgkuphctznykli.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY),o=await e();if(!o?.user?.email)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{data:n,error:a}=await s.from("users").select("*").eq("email",o.user.email).single();if(a||!n)return i.NextResponse.json({error:"User not found"},{status:404});let{data:u,error:p}=await s.from("projects").select("*").eq("user_id",n.id).eq("enabled",!0).order("created_at",{ascending:!1});if(p)return console.error("Error fetching projects:",p),i.NextResponse.json({error:"Failed to fetch projects"},{status:500});return i.NextResponse.json(u)}catch(e){return console.error("Projects fetch error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/projects/route",pathname:"/api/projects",filename:"route",bundlePath:"app/api/projects/route"},resolvedPagePath:"C:\\Users\\NANGU BHUPATHI REDDY\\Downloads\\fuck 1.1\\console-text\\packages\\dashboard\\src\\app\\api\\projects\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:x,serverHooks:m}=l,g="/api/projects/route";function j(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:x})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[193,746],()=>t(22614));module.exports=s})();